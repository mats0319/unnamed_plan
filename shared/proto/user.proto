syntax = "proto3";
package user;

option go_package = "./rpc_impl";
option optimize_for = LITE_RUNTIME;

import "common.proto";

service IUser {
  // functions
  rpc Login(User.LoginReq) returns (User.LoginRes);
  rpc List(User.ListReq) returns (User.ListRes);
  rpc Create(User.CreateReq) returns (User.CreateRes);
  rpc Lock(User.LockReq) returns (User.LockRes);
  rpc Unlock(User.UnlockReq) returns (User.UnlockRes);
  rpc ModifyInfo(User.ModifyInfoReq) returns (User.ModifyInfoRes);
  rpc ModifyPermission(User.ModifyPermissionReq) returns (User.ModifyPermissionRes);

  // for other services
  rpc Authenticate(User.AuthenticateReq) returns (User.AuthenticateRes);
}

message User {
  message Data {
    string user_id = 1;
    string user_name = 2;
    string nickname = 3;
    bool is_locked = 4;
    uint32 permission = 5;
    string created_by = 6;
  }

  message LoginReq {
    string user_name = 1;
    string password = 2;
  }

  message LoginRes {
    string user_id = 1;
    string nickname = 2;
    uint32 permission = 3;
  }

  message ListReq {
    string operator_id = 1;

    common.Pagination page = 15;
  }

  message ListRes {
    uint32 total = 1;
    repeated Data users = 2;
  }

  message CreateReq {
    string operator_id = 1;
    string user_name = 2;
    string password = 3;
    uint32 permission = 4;
  }

  message CreateRes {
  }

  message LockReq {
    string operator_id = 1;
    string user_id = 2;
  }

  message LockRes {
  }

  message UnlockReq {
    string operator_id = 1;
    string user_id = 2;
  }

  message UnlockRes {
  }

  message ModifyInfoReq {
    string operator_id = 1;
    string user_id = 2;
    string curr_pwd = 3;
    string nickname = 4;
    string password = 5;
  }

  message ModifyInfoRes {
  }

  message ModifyPermissionReq {
    string operator_id = 1;
    string user_id = 2;
    uint32 permission = 3;
  }

  message ModifyPermissionRes {
  }

  message AuthenticateReq {
    string user_id = 1;
    string password = 2;
  }

  message AuthenticateRes {
  }
}
